pipeline{
  agent { label 'master'}
  tools{
    maven '3.6.3'
  }
  stages{
    stage("Build Spring Project"){
      steps{
        sh "mvn clean package"
      }
    }
    stage("Deploy Service"){
      steps{
        //sh "docker compose up -d --build"
        script{
          docker.withRegistry('', 'dockerhub-auth') {
            def customImage = docker.build("xeng/spring-register:${BUILD_NUMBER}")
              /* Push the container to the custom Registry */
              customImage.push()
          }
        }
        sh 'docker logout'
      }
    }
  }
}
